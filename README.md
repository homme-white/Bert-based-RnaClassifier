# Bert-based-RnaClassifierHierarchical_Attentive_Multi-modal_Fusion-ncRNAClassifier：基于分层注意力融合多模态信息的ncRNA分类器
# RNA-Classifier: 基于分层注意力融合多模态信息的ncRNA分类器

[![Python 3.9](https://img.shields.io/badge/python-3.9-blue.svg)](https://www.python.org/downloads/release/python-390/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## 项目简介

本项目是东北大学计算机科学与工程学院本科毕业设计《基于多模态融合的ncRNA分类方法的设计与实现》的官方代码实现。该项目旨在开发一个高效、精准的计算工具，用于准确地区分非编码RNA（ncRNA）与信使RNA（mRNA），以辅助生物信息学领域的深入研究。

非编码RNA（Non-coding RNA, ncRNA）在基因调控和多种疾病机理中扮演着至关重要的角色。准确地将其与编码蛋白质的信使RNA（mRNA）区分开来，是理解其功能的关键一步。本项目针对现有计算方法在特征提取和融合方面的局限性，开发了一种基于多模态信息融合的深度学习分类方法，以期提升分类的准确性和可靠性。

---

## 核心特性

- **多模态特征融合**: 整合了RNA的三个关键特征维度，提供更全面的信息表征：
    - **序列深层语义特征**: 利用先进的 **BERT** 模型提取。
    - **理化属性特征**: 基于 **电子-离子相互作用赝势 (EIIP)** 计算。
    - **二级结构特征**: 使用 **RNAfold** 预测并进行数值化编码。
- **先进的序列表示**: 创新性地采用 **BERT模型** 结合 **6-mer分词策略**，有效处理长RNA序列（最高可达3072个碱基）并捕捉深层上下文信息。
- **高效的融合网络**: 设计并实现了一个 **分层注意力融合网络 (CrossModalFusion)**，通过跨模态注意力和动态门控机制，实现特征的深度交互与自适应加权整合，性能显著优于传统融合方法。
- **用户友好的图形界面**: 提供一个使用PySide6构建的直观GUI，方便非计算机背景的研究人员直接输入RNA序列进行分类预测。

---

## 技术架构

本项目的核心架构在于对多模态特征进行分层处理与智能融合，最终由高效的分类网络进行判别。

### 架构概述

1.  **特征增强处理模块 (Processor)**: 针对三种异构特征，我们设计了独立的模块进行特异性增强和维度统一。
    - **`BERTProcessor`**: 通过全连接层降维、自适应池化和SE通道注意力模块，提炼并统一BERT序列特征。
    - **`PSEProcessor`**: 通过MLP增强、上采样和SE模块，将全局理化特征向量（EIIP）扩展并适配为与其它模态维度一致的序列化表示。
    - **`RNAfoldProcessor`**: 结合一维卷积（CNN）、Transformer编码器和池化操作，从RNA二级结构中提取从局部到全局的拓扑特征。

2.  **分层融合模块 (CrossModalFusion)**: 这是本项目的核心创新，用于高效整合处理后的多模态特征。
    - **跨模态注意力 (Cross-modal Attention)**: 以信息最丰富的BERT特征为查询（Query），分别与其他模态特征进行注意力计算，实现信息的深度交互与对齐。
    - **动态门控融合 (DynamicFusionGate)**: 对经过注意力交互后的特征流，通过一个可学习的门控机制进行自适应加权求和，使模型能够动态调整不同信息的贡献度，生成最优的融合表征。

3.  **分类器 (EfficientClassifier)**:
    - 采用经过输入层和分类头修改的 **EfficientNet-B1** 网络，对融合后的高维特征进行最终的分类判别，在性能和效率之间取得了良好的平衡。

---

## 性能表现

### 最终模型性能
在独立的测试集上，我们提出的多模态融合模型（`HYBRID`）取得了优异的性能：

| 指标 | 数值 |
| :--- | :--- |
| 准确率 (ACC) | 83.10% |
| F1分数 (F1-score) | 83.34% |
| AUC | 90.96% |
| MCC | 66.23% |


### 消融实验 (Ablation Study)
为了验证多模态信息中每种特征的贡献，我们进行了消融实验。结果表明，多特征融合模型性能全面超越任何单一特征模型，证明了信息整合的有效性。

**各特征在测试集上的性能对比**:

| 模型/特征 | F1-score | AUC | MCC |
| :--- | :--- | :--- | :--- |
| BERT (序列) | 81.21% | 89.03% | 62.59% |
| pseEIIP (理化) | 80.19% | 89.04% | 61.76% |
| RNAfold (结构) | 65.92% | 68.36% | 26.32% |
| **多特征融合 (本文方法)** | **83.34%** | **90.96%** | **66.23%** |


### 融合方法对比 (Fusion Method Comparison)
为了验证我们提出的分层注意力融合机制的优越性，我们与其他融合方法进行了对比。实验证明，本文方法在各项综合指标上表现最佳。

**不同融合方法在测试集上的性能对比**:

| 融合方法 | F1-score | AUC | MCC |
| :--- | :--- | :--- | :--- |
| 降维拼接法 | 81.27% | 89.10% | 62.50% |
| 单层注意力 | 82.19% | 89.40% | 63.80% |
| **多层注意力 (本文方法)** | **83.34%** | **90.96%** | **66.23%** |

## 项目结构
Bert-based-RnaClassifier/
├── data_example/         # 存放用于模型输入的样例数据文件
├── evaluate/             # 存放模型评估相关的脚本（如计算性能指标）
├── figure/               # 存放论文中使用的图表和训练过程中的可视化结果
├── model/                # 包含模型的预训练文件
├── run/                  # 存放GUI界面及其后端的程序，运行GUI.py启动
├── tools/                # 包含开发过程中使用的辅助工具脚本（如数据预处理、特征计算等）
├── train/                # 包含不同模型的训练脚本
├── README.md             # 项目说明文件
└── requirements.txt      # 项目依赖库列表